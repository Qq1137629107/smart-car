C51 COMPILER V9.60.0.0   SMG                                                               11/20/2022 19:44:07 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE SMG
OBJECT MODULE PLACED IN .\Objects\smg.obj
COMPILER INVOKED BY: D:\APP\Keil\C51\BIN\C51.EXE smg.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\smg.
                    -lst) TABS(2) OBJECT(.\Objects\smg.obj)

line level    source

   1          #include "smg.h"
   2          
   3          sbit SW1=P3^0;
   4          sbit SW2=P3^1;
   5          sbit SW3=P3^2;
   6          static u8 x, y;
   7          
   8          extern u8 s1;
   9          
  10          
  11          u8 Smg_Display[20]={0x14,0xd7,0x4c,0x45,0x87,0x25,0x24,0x57,0x04,0x05,
  12                              0x10,0xd3,0x48,0x41,0x83,0x21,0x20,0x53,0x00,0x01};
  13          
  14          void Hc595_Send_Dat2(u8 dat)
  15          {
  16   1        u8 i=0;
  17   1        for(i=0 ;i<8;i++)
  18   1        {
  19   2          SER2=dat>>7;
  20   2          dat<<=1;
  21   2          SRCLK2=0;
  22   2          SRCLK2=1;
  23   2        }
  24   1        RCLK2=0;
  25   1        RCLK2=1;
  26   1      }
  27          
  28          void delay2_5ms(u8 ms)
  29          {
  30   1        u8 T = 0;
  31   1        AUXR &= 0x7F;   //定时器时钟12T模式
  32   1        TMOD &= 0xF0;   //设置定时器模式
  33   1        TL0 = 0x00;   //设置定时初始值
  34   1        TH0 = 0xE5;   //设置定时初始值  
  35   1        TR0 = 1;    //定时器0开始计时
  36   1        
  37   1        while (T < ms)
  38   1        {
  39   2          if (TF0 == 1)
  40   2          {
  41   3            TF0 = 0;
  42   3            T++;
  43   3          }
  44   2        }
  45   1      }
  46          
  47          
  48          void flash()
  49          {
  50   1        S3=0;
  51   1        S2=1;
  52   1        S1=1;
  53   1        S0=1;
  54   1        Hc595_Send_Dat2(Smg_Display[y%10]);
C51 COMPILER V9.60.0.0   SMG                                                               11/20/2022 19:44:07 PAGE 2   

  55   1        delay2_5ms(1);
  56   1        Hc595_Send_Dat2(0xff);   
  57   1      
  58   1        S3=1;
  59   1        S2=0;
  60   1        S1=1;
  61   1        S0=1;
  62   1        Hc595_Send_Dat2(Smg_Display[y/10%10]);
  63   1        delay2_5ms(1);
  64   1        Hc595_Send_Dat2(0xff);   
  65   1        
  66   1        S3=1;
  67   1        S2=1;
  68   1        S1=0;
  69   1        S0=1;
  70   1        Hc595_Send_Dat2(Smg_Display[x%10+10]);
  71   1        delay2_5ms(1);
  72   1        Hc595_Send_Dat2(0xff);
  73   1        
  74   1        S3=1;
  75   1        S2=1;
  76   1        S1=1;
  77   1        S0=0;
  78   1        Hc595_Send_Dat2(Smg_Display[x/10%10]);
  79   1        delay2_5ms(1);
  80   1        Hc595_Send_Dat2(0xff);
  81   1      } 
  82          
  83          void timer()
  84          {
  85   1        u8 T = 0;
  86   1        AUXR &= 0x7F;   //定时器时钟12T模式
  87   1        TMOD &= 0xF0;   //设置定时器模式
  88   1        TL0 = 0x00;   //设置定时初始值
  89   1        TH0 = 0xE5;   //设置定时初始值  
  90   1        flash();
  91   1        TR0 = 1;
  92   1        while (T < 80)
  93   1        {
  94   2          if (TF0 == 1)
  95   2          {
  96   3            TF0 = 0; 
  97   3            flash();  
  98   3            T++;
  99   3          }
 100   2        }
 101   1      }
 102          
 103          void jishiqi()
 104          {
 105   1        
 106   1        while (1)
 107   1        {
 108   2          y++;
 109   2          if (y > 59)
 110   2          {
 111   3          x++;
 112   3          y = 0;
 113   3          }
 114   2                  
 115   2          if (x > 59)
 116   2          {
C51 COMPILER V9.60.0.0   SMG                                                               11/20/2022 19:44:07 PAGE 3   

 117   3            x = 0;
 118   3          }
 119   2                  
 120   2          timer();
 121   2          if(SW2==0&&SW3==0)  
 122   2            return;
 123   2          if(SW3==0)
 124   2          {
 125   3            while(!SW3);
 126   3            if(s1==1)
 127   3            s1=2;
 128   3            TR0=0;
 129   3            while(1)
 130   3            {
 131   4              flash();
 132   4              if(SW1==0)
 133   4              {
 134   5                while(!SW1);
 135   5                  x++;
 136   5                if(x>59)x=0;
 137   5              }
 138   4              if(SW2==0)
 139   4              {
 140   5                while(!SW2);
 141   5                  y++;
 142   5                if(x>59)y=0;
 143   5              }
 144   4              if(SW3==0)
 145   4              {
 146   5                if(s1==2)
 147   5                s1=1;
 148   5                break;
 149   5              }
 150   4            }
 151   3          }
 152   2        }
 153   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    326    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     22    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
